let y=null,x="",i=[],n=new Set(["all"]),w=0;const O=12;document.addEventListener("DOMContentLoaded",async()=>{const o=document.getElementById("search-input"),k=document.getElementById("search-results"),S=document.getElementById("status-text"),E=document.getElementById("loading"),m=document.getElementById("load-more-container"),F=document.getElementById("load-more-btn"),_=o?.closest("form"),W=document.querySelectorAll("[data-filter]"),b=document.getElementById("filters-and-status"),f=document.getElementById("clear-search"),g=document.getElementById("no-results"),M=document.getElementById("no-results-query");try{const s=await new Function("path","return import(path)")("/pagefind/pagefind.js");if(y=s?.default||s,!y||typeof y.init!="function"||typeof y.search!="function")throw new Error("Pagefind API not available");await y.init(),console.log("Pagefind initialized successfully")}catch(e){console.error("Failed to initialize Pagefind:",e),L("Search is currently unavailable. Make sure your site has been built with Pagefind enabled."),T();return}const N=new URLSearchParams(window.location.search),j=N.get("q"),z=N.get("filters");if(z){const e=z.split(",").filter(t=>t.length>0);e.length>0&&(n.clear(),e.forEach(t=>n.add(t)),v())}j&&o?(o.value=j,f&&j.trim().length>0&&f.classList.remove("hidden"),U(j)):A(),_&&_.addEventListener("submit",e=>{e.preventDefault();const t=o&&"value"in o?String(o.value).trim():"";t&&(o&&typeof o.blur=="function"&&o.blur(),B(t),U(t))}),o&&o.addEventListener("input",e=>{const t=e.target,s=t&&"value"in t?String(t.value).trim():"";if(f&&(s.length>0?f.classList.remove("hidden"):f.classList.add("hidden")),s.length===0){C(),A(),x="",B("");return}}),f&&f.addEventListener("click",()=>{o&&"value"in o&&(o.value="",typeof o.focus=="function"&&o.focus(),f.classList.add("hidden"),C(),A(),x="",B(""))}),W.forEach(e=>{e.addEventListener("click",G)}),F&&F.addEventListener("click",V),window.addEventListener("popstate",()=>{});function G(e){const t=e.currentTarget,s=t.getAttribute("data-filter");!s||t.disabled||(new Set(n),s==="all"?(n.clear(),n.add("all"),v()):(n.has("all")&&n.delete("all"),n.has(s)?n.delete(s):n.add(s),n.size===0&&n.add("all"),v()),B(x),i.length>0&&R())}function v(){document.querySelectorAll("[data-filter]").forEach(t=>{const s=t.getAttribute("data-filter"),a=n.has(s||"");let r=!0;s!=="all"&&(i.length===0?r=!1:r=i.some(d=>d.contentType===s)),a?(t.className="px-4 py-2 text-sm font-medium rounded-lg border transition-colors duration-200 focus:z-10 focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600 text-white bg-gray-900 border-gray-900 hover:bg-black hover:border-black dark:bg-gray-700 dark:border-gray-700 dark:hover:bg-gray-600 dark:hover:border-gray-600 cursor-pointer whitespace-nowrap",t.setAttribute("aria-pressed","true")):(t.className="px-4 py-2 text-sm font-medium rounded-lg border transition-colors duration-200 focus:z-10 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-800 text-gray-600 bg-white border-gray-300 hover:bg-gray-50 hover:border-gray-400 dark:text-gray-400 dark:bg-gray-800 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:hover:border-gray-500 cursor-pointer whitespace-nowrap",t.setAttribute("aria-pressed","false")),!r&&s!=="all"?(t.disabled=!0,t.className=t.className+" opacity-50 cursor-not-allowed"):(t.disabled=!1,t.className=t.className.replace(" opacity-50 cursor-not-allowed",""))})}function B(e){const t=new URL(window.location.href);e?t.searchParams.set("q",e):t.searchParams.delete("q");const s=Array.from(n);s.length===1&&s[0]==="all"?t.searchParams.delete("filters"):t.searchParams.set("filters",s.join(",")),window.history.replaceState(null,"",t.toString())}function J(){E&&E.classList.remove("hidden")}function I(){E&&E.classList.add("hidden")}function T(){b&&b.classList.remove("hidden"),g&&g.classList.add("hidden")}function A(){b&&b.classList.add("hidden"),g&&g.classList.add("hidden")}function K(e){g&&g.classList.remove("hidden"),b&&b.classList.add("hidden"),M&&(M.textContent=`We couldn't find anything for "${e}". Try different keywords or check your spelling.`)}function L(e){let t=e;t=t.replace(/Found (\d+) result/g,'Found <span class="font-semibold text-gray-900 dark:text-white">$1</span> result'),t=t.replace(/Showing (\d+) of (\d+) results/g,'Showing <span class="font-semibold text-gray-900 dark:text-white">$1</span> of <span class="font-semibold text-gray-900 dark:text-white">$2</span> results'),S&&(S.className="text-sm font-normal text-gray-500 dark:text-gray-400",S.innerHTML=t),T(),I()}function C(){k&&(k.innerHTML=""),g&&g.classList.add("hidden"),w=0,i=[],v(),m&&m.classList.add("hidden")}function V(){R(!1)}async function U(e){if(!(!y||e===x)){console.log("Performing search for:",e),x=e,J(),T(),C();try{const t=await y.search(e);if(console.log("Search results:",t.results.length),I(),t.results.length===0){i=[],v(),K(e);return}i=(await Promise.all(t.results.map(async a=>{try{const r=await a.data();return console.log("Result metadata:",r.meta),{data:r,contentType:X(r),card:Z(r)}}catch(r){return console.error("Error processing result:",r),null}}))).filter(a=>a!==null),console.log("Processed results:",i.length),Y(),v(),R()}catch(t){I(),console.error("Search error:",t),L("An error occurred while searching. Please try again.")}}}function X(e){if(e.filters&&e.filters.type){const t=e.filters.type[0];if(t==="product")return"products";if(t==="service")return"services";if(t==="project")return"projects";if(t==="post")return"posts"}return e.url.includes("/products/")?"products":e.url.includes("/services/")?"services":e.url.includes("/projects/")?"projects":e.url.includes("/blog/")?"posts":"page"}function Y(){if(i.length===0){const l=document.getElementById("count-all"),H=document.getElementById("count-products"),q=document.getElementById("count-services"),Q=document.getElementById("count-projects"),D=document.getElementById("count-posts");l&&(l.textContent=""),H&&(H.textContent=""),q&&(q.textContent=""),Q&&(Q.textContent=""),D&&(D.textContent="");return}const e={products:0,services:0,projects:0,posts:0,page:0};i.forEach(l=>{e.hasOwnProperty(l.contentType)&&e[l.contentType]++});const t=i.length,s=document.getElementById("count-all"),a=document.getElementById("count-products"),r=document.getElementById("count-services"),d=document.getElementById("count-projects"),u=document.getElementById("count-posts"),h=`(${t})`,c=e.products>0?`(${e.products})`:"",P=e.services>0?`(${e.services})`:"",$=e.projects>0?`(${e.projects})`:"",p=e.posts>0?`(${e.posts})`:"";s&&(s.textContent=h),a&&(a.textContent=c),r&&(r.textContent=P),d&&(d.textContent=$),u&&(u.textContent=p)}function R(e=!0){if(i.length===0)return;let t=i;n.has("all")||(t=i.filter(c=>n.has(c.contentType)));const s=i.length,a=t.length;n.has("all")?L(`Found ${s} result${s!==1?"s":""} for "${x}"`):L(`Showing ${a} of ${s} results for "${x}"`);const r=e?0:w,d=e?O:w+O,u=t.slice(r,d),h=u.map(c=>c.card).filter(c=>c!==null);k&&(e?(k.innerHTML=h.join(""),w=u.length):(k.innerHTML+=h.join(""),w+=u.length)),m&&(w<t.length?m.classList.remove("hidden"):m.classList.add("hidden")),t.length===0&&s>0&&(L("No results found for the selected filters. Try selecting different content types."),m&&m.classList.add("hidden"))}function Z(e){if(!e)return null;let t="Page",s="page";if(e.filters&&e.filters.type){const p=e.filters.type[0];p==="project"?(t="Project",s="projects"):p==="product"?(t="Product",s="products"):p==="service"?(t="Service",s="services"):p==="post"&&(t="Blog Post",s="posts")}else e.url.includes("/products/")?(t="Product",s="products"):e.url.includes("/services/")?(t="Service",s="services"):e.url.includes("/projects/")?(t="Project",s="projects"):e.url.includes("/blog/")&&(t="Blog Post",s="posts");const a=e.meta?.image||e.meta?.thumbnail||"/https://res.cloudinary.com/dxyjku3eh/image/upload/v1754820661/Tanpa_judul_Presentasi__20250810_170926_0000_vdiibn.png",r=e.meta?.title||e.title||"Untitled",d=e.meta?.organiser||"",u=e.meta?.locale||"",h=e.meta?.countries||"",c=e.meta?.categories||"";let P="";s==="projects"&&h?P=`<p>
          ${h.split(",").map(l=>String(l).trim()).map(l=>`<span class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium border border-solid border-gray-300 bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-300 ml-2 mt-4 mb-2">
              ${l}
            </span>`).join("")}
        </p>`:s==="posts"&&c&&(P=`<p>
          ${c.split(",").map(l=>String(l).trim()).filter(l=>l.length>0).map(l=>`<span class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium border border-solid border-gray-300 bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-300 ml-2 mt-4 mb-2">
              ${l}
            </span>`).join("")}
        </p>`);let $="";return s==="projects"&&d&&u&&($=`<p class="mt-2 text-sm font-normal text-gray-400 dark:text-gray-400 px-4">
          By <span class="text-gray-800 dark:text-gray-200">${d}</span> in <span class="text-gray-900 dark:text-gray-100">${u}</span>
        </p>`),`
        <article class="rounded-lg">
          <div class="relative">
            <a href="${e.url}">
              <img 
                class="w-full rounded-lg h-64 object-cover" 
                src="${a}" 
                alt="${r}"
                loading="lazy"
                onerror="this.src='/https://res.cloudinary.com/dxyjku3eh/image/upload/v1754820661/Tanpa_judul_Presentasi__20250810_170926_0000_vdiibn.png'"
              />
            </a>
            <span class="absolute top-2 left-2 inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium border border-solid border-blue-300 bg-blue-50 text-blue-800 dark:bg-blue-900 dark:text-blue-300">
              ${t}
            </span>
          </div>
          ${P}
          <h2 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white px-4">
            <a href="${e.url}">
              ${r}
            </a>
          </h2>
          ${$}
        </article>
      `}});
